<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Iframe Test - Cross Origin</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 900px;
      margin: 2rem auto;
      line-height: 1.6;
      padding: 0 1rem;
    }
    h1 { color: #1e40af; }
    .test-section {
      margin: 2rem 0;
      padding: 1rem;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
    }
    iframe {
      width: 100%;
      height: 400px;
      border: 2px dashed #cbd5e1;
      border-radius: 4px;
      margin: 1rem 0;
    }
    .note {
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 1rem;
      margin: 1rem 0;
    }
    .warning {
      background: #fee2e2;
      border-left: 4px solid #dc2626;
      padding: 1rem;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <h1>Remarq Iframe Test - Cross Origin</h1>
  
  <div class="note">
    <strong>Test Objective:</strong> Verify that cross-origin iframes cannot be annotated 
    (blocked by browser same-origin policy).
  </div>

  <div class="test-section">
    <h2>Parent Page Content (Expected: ✅ Annotatable)</h2>
    <p>
      This text is in the parent document and should be annotatable. Select this paragraph 
      to verify the "Annotate" button appears.
    </p>
  </div>

  <div class="test-section">
    <h2>Cross-Origin Iframe (Expected: ❌ Not Annotatable)</h2>
    <p>
      The iframe below loads content from <code>https://example.com</code> (different origin).
    </p>
    <iframe src="https://example.com"></iframe>
    <div class="warning">
      <strong>Same-Origin Policy:</strong> Cross-origin iframes are completely inaccessible 
      to the parent page's JavaScript. The browser blocks access to <code>iframe.contentDocument</code> 
      for security reasons. This is a fundamental browser restriction and cannot be worked around 
      without cooperation from the iframe source.
    </div>
    <p>
      <strong>Result:</strong> Content inside the iframe cannot be selected or annotated by Remarq.
      This is expected behavior and not a bug.
    </p>
  </div>

  <div class="test-section">
    <h2>Workaround for Cross-Origin Iframes</h2>
    <p>
      If you need to annotate content inside a cross-origin iframe, you must embed the Remarq 
      script <strong>inside the iframe's source document</strong>. The iframe source must:
    </p>
    <ol>
      <li>Include the <code>&lt;script src="feedback-layer.js"&gt;</code> tag</li>
      <li>Set the appropriate <code>data-api-url</code> and <code>data-document-id</code></li>
      <li>Ensure CORS headers allow communication with your Remarq server</li>
    </ol>
    <p>
      This is only possible if you control the iframe source or can coordinate with its owner.
    </p>
  </div>

  <script src="feedback-layer.js" 
    data-api-url="http://localhost:3333"
    data-content-selector="body"
    data-document-id="iframe-test-cross-origin"></script>
</body>
</html>
